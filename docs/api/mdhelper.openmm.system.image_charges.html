<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="register_particles" href="mdhelper.openmm.system.register_particles.html" /><link rel="prev" title="estimate_pressure_tensor" href="mdhelper.openmm.system.estimate_pressure_tensor.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>image_charges - MDHelper documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">MDHelper  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="mdhelper.html">API Reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="mdhelper.algorithm.html">algorithm</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of algorithm</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.algorithm.correlation.html">correlation</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of correlation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.algorithm.correlation.correlation_fft.html">correlation_fft</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.algorithm.correlation.correlation_shift.html">correlation_shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.algorithm.correlation.msd_fft.html">msd_fft</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.algorithm.correlation.msd_shift.html">msd_shift</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.algorithm.molecule.html">molecule</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of molecule</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.algorithm.molecule.center_of_mass.html">center_of_mass</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.algorithm.molecule.radius_of_gyration.html">radius_of_gyration</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.algorithm.topology.html">topology</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of topology</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.algorithm.topology.create_atoms.html">create_atoms</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.algorithm.utility.html">utility</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of utility</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.algorithm.utility.closest_factors.html">closest_factors</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.algorithm.utility.rebin.html">rebin</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.algorithm.utility.replicate.html">replicate</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="mdhelper.analysis.html">analysis</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of analysis</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.analysis.base.html">base</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of base</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.base.ParallelAnalysisBase.html">ParallelAnalysisBase</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.base.SerialAnalysisBase.html">SerialAnalysisBase</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mdhelper.analysis.electrostatics.html">electrostatics</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.analysis.polymer.html">polymer</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of polymer</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.polymer.correlation_fft.html">correlation_fft</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.polymer.correlation_shift.html">correlation_shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.polymer.relaxation_time.html">relaxation_time</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.polymer.Gyradius.html">Gyradius</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.polymer.ParallelSingleChainStructureFactor.html">ParallelSingleChainStructureFactor</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.polymer.Relaxation.html">Relaxation</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.polymer.SingleChainStructureFactor.html">SingleChainStructureFactor</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.analysis.profile.html">profile</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of profile</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.profile.potential_profile.html">potential_profile</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.profile.DensityProfile.html">DensityProfile</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.analysis.structure.html">structure</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of structure</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.structure.coordination_numbers.html">coordination_numbers</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.structure.radial_fourier_transform.html">radial_fourier_transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.structure.radial_histogram.html">radial_histogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.structure.structure_factor.html">structure_factor</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.structure.IncoherentIntermediateScatteringFunction.html">IncoherentIntermediateScatteringFunction</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.structure.ParallelIncoherentIntermediateScatteringFunction.html">ParallelIncoherentIntermediateScatteringFunction</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.structure.ParallelRDF.html">ParallelRDF</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.structure.ParallelStructureFactor.html">ParallelStructureFactor</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.structure.RDF.html">RDF</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.structure.StructureFactor.html">StructureFactor</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.analysis.transport.html">transport</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of transport</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.transport.coefficients.html">coefficients</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.transport.conductivity.html">conductivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.transport.electrophoretic_mobility.html">electrophoretic_mobility</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.transport.msd_fft.html">msd_fft</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.transport.msd_shift.html">msd_shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.transport.transference_number.html">transference_number</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.analysis.transport.Onsager.html">Onsager</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="mdhelper.fit.html">fit</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of fit</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.fit.distribution.html">distribution</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of distribution</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.distribution.weibull.html">weibull</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.fit.exponential.html">exponential</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of exponential</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.exponential.exp.html">exp</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.exponential.exp1.html">exp1</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.exponential.exp2.html">exp2</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.exponential.stretched_exp.html">stretched_exp</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.fit.fourier.html">fourier</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of fourier</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.fourier.fourier.html">fourier</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.fourier.fourier1.html">fourier1</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.fourier.fourier2.html">fourier2</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.fourier.fourier3.html">fourier3</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.fourier.fourier4.html">fourier4</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.fourier.fourier5.html">fourier5</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.fourier.fourier6.html">fourier6</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.fourier.fourier7.html">fourier7</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.fourier.fourier8.html">fourier8</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.fit.gaussian.html">gaussian</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of gaussian</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.gaussian.gauss.html">gauss</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.gaussian.gauss1.html">gauss1</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.gaussian.gauss2.html">gauss2</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.gaussian.gauss3.html">gauss3</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.gaussian.gauss4.html">gauss4</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.gaussian.gauss5.html">gauss5</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.gaussian.gauss6.html">gauss6</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.gaussian.gauss7.html">gauss7</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.gaussian.gauss8.html">gauss8</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.fit.polynomial.html">polynomial</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of polynomial</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.polynomial.poly.html">poly</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.polynomial.poly1.html">poly1</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.polynomial.poly2.html">poly2</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.polynomial.poly3.html">poly3</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.polynomial.poly4.html">poly4</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.polynomial.poly5.html">poly5</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.polynomial.poly6.html">poly6</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.polynomial.poly7.html">poly7</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.polynomial.poly8.html">poly8</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.polynomial.poly9.html">poly9</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.fit.power.html">power</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of power</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.power.power.html">power</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.power.power1.html">power1</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.fit.power.power2.html">power2</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="mdhelper.openmm.html">openmm</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of openmm</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.openmm.bond.html">bond</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of bond</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.openmm.bond.fene.html">fene</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.openmm.file.html">file</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of file</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.openmm.file.NetCDFFile.html">NetCDFFile</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.openmm.pair.html">pair</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of pair</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.openmm.pair.coul_gauss.html">coul_gauss</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.openmm.pair.dpd.html">dpd</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.openmm.pair.gauss.html">gauss</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.openmm.pair.lj_coul.html">lj_coul</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.openmm.pair.ljts.html">ljts</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.openmm.pair.solvation.html">solvation</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.openmm.pair.yukawa.html">yukawa</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.openmm.reporter.html">reporter</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of reporter</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.openmm.reporter.NetCDFReporter.html">NetCDFReporter</a></li>
</ul>
</li>
<li class="toctree-l3 current has-children"><a class="reference internal" href="mdhelper.openmm.system.html">system</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of system</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="mdhelper.openmm.system.electric_field.html">electric_field</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.openmm.system.estimate_pressure_tensor.html">estimate_pressure_tensor</a></li>
<li class="toctree-l4 current current-page"><a class="current reference internal" href="#">image_charges</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.openmm.system.register_particles.html">register_particles</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.openmm.system.slab_correction.html">slab_correction</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.openmm.topology.html">topology</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of topology</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.openmm.topology.create_atoms.html">create_atoms</a></li>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.openmm.topology.subset.html">subset</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.openmm.unit.html">unit</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of unit</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.openmm.unit.lj_scaling.html">lj_scaling</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.openmm.utility.html">utility</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of utility</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.openmm.utility.optimize_pme.html">optimize_pme</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="mdhelper.plot.html">plot</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle navigation of plot</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.plot.axis.html">axis</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle navigation of axis</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.plot.axis.tabular_legend.html">tabular_legend</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mdhelper.plot.rcparam.html">rcparam</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle navigation of rcparam</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mdhelper.plot.rcparam.update.html">update</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="image-charges">
<h1>image_charges<a class="headerlink" href="#image-charges" title="Link to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="mdhelper.openmm.system.image_charges">
<span class="sig-prename descclassname"><span class="pre">mdhelper.openmm.system.</span></span><span class="sig-name descname"><span class="pre">image_charges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://docs.openmm.org/latest/api-python/generated/openmm.openmm.System.html#openmm.openmm.System" title="(in OpenMM Python API v8.0.0)"><span class="pre">System</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">topology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://docs.openmm.org/latest/api-python/generated/openmm.app.topology.Topology.html#openmm.app.topology.Topology" title="(in OpenMM Python API v8.0.0)"><span class="pre">Topology</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><span class="pre">ndarray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="http://docs.openmm.org/latest/api-python/generated/openmm.unit.quantity.Quantity.html#openmm.unit.quantity.Quantity" title="(in OpenMM Python API v8.0.0)"><span class="pre">Quantity</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="http://docs.openmm.org/latest/api-python/generated/openmm.unit.quantity.Quantity.html#openmm.unit.quantity.Quantity" title="(in OpenMM Python API v8.0.0)"><span class="pre">Quantity</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="http://docs.openmm.org/latest/api-python/generated/openmm.unit.quantity.Quantity.html#openmm.unit.quantity.Quantity" title="(in OpenMM Python API v8.0.0)"><span class="pre">Quantity</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="http://docs.openmm.org/latest/api-python/generated/openmm.unit.quantity.Quantity.html#openmm.unit.quantity.Quantity" title="(in OpenMM Python API v8.0.0)"><span class="pre">Quantity</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cells</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbforce</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://docs.openmm.org/latest/api-python/generated/openmm.openmm.NonbondedForce.html#openmm.openmm.NonbondedForce" title="(in OpenMM Python API v8.0.0)"><span class="pre">NonbondedForce</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cnbforces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="http://docs.openmm.org/latest/api-python/generated/openmm.openmm.CustomNonbondedForce.html#openmm.openmm.CustomNonbondedForce" title="(in OpenMM Python API v8.0.0)"><span class="pre">CustomNonbondedForce</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="http://docs.openmm.org/latest/api-python/generated/openmm.openmm.CustomNonbondedForce.html#openmm.openmm.CustomNonbondedForce" title="(in OpenMM Python API v8.0.0)"><span class="pre">CustomNonbondedForce</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wall_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ArrayLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="http://docs.openmm.org/latest/api-python/generated/openmm.unit.quantity.Quantity.html#openmm.unit.quantity.Quantity" title="(in OpenMM Python API v8.0.0)"><span class="pre">Quantity</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://docs.openmm.org/latest/api-python/generated/openmm.openmm.Integrator.html#openmm.openmm.Integrator" title="(in OpenMM Python API v8.0.0)"><span class="pre">Integrator</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mdhelper/openmm/system.html#image_charges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mdhelper.openmm.system.image_charges" title="Link to this definition">#</a></dt>
<dd><p>Implements the method of image charges for perfectly conducting
boundaries (with a relative permittivity of
<span class="math notranslate nohighlight">\(\varepsilon_\mathrm{r}=\infty\)</span>). For more information about
the method, see Refs. <a class="reference internal" href="#rb319b78fd6ee-1" id="id1">[1]</a>, <a class="reference internal" href="#rb319b78fd6ee-2" id="id2">[2]</a>, and <a class="reference internal" href="#rb319b78fd6ee-3" id="id3">[3]</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The boundaries must be in the $xy$-plane and along the $z$-axis.</p>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>system</strong><span class="classifier"><cite>openmm.System</cite></span></dt><dd><p>OpenMM molecular system.</p>
</dd>
<dt><strong>topology</strong><span class="classifier"><cite>openmm.app.Topology</cite></span></dt><dd><p>Topological information about an OpenMM system.</p>
</dd>
<dt><strong>positions</strong><span class="classifier"><cite>numpy.ndarray</cite></span></dt><dd><p>Positions of the <span class="math notranslate nohighlight">\(N\)</span> particles in the real system.</p>
<p><strong>Shape</strong>: <span class="math notranslate nohighlight">\((N,\,,3)\)</span>.</p>
<p><strong>Reference unit</strong>: <span class="math notranslate nohighlight">\(\mathrm{nm}\)</span>.</p>
</dd>
<dt><strong>temp</strong><span class="classifier"><cite>float</cite> or <cite>openmm.unit.Quantity</cite></span></dt><dd><p>System temperature <span class="math notranslate nohighlight">\(T\)</span>.</p>
<p><strong>Reference unit</strong>: <span class="math notranslate nohighlight">\(\mathrm{K}\)</span>.</p>
</dd>
<dt><strong>fric</strong><span class="classifier"><cite>float</cite> or <cite>openmm.unit.Quantity</cite></span></dt><dd><p>Friction coefficient <span class="math notranslate nohighlight">\(\gamma\)</span> that couples the system to
the heat bath.</p>
<p><strong>Reference unit</strong>: <span class="math notranslate nohighlight">\(\mathrm{ps}^{-1}\)</span>.</p>
</dd>
<dt><strong>dt</strong><span class="classifier"><cite>float</cite> or <cite>openmm.unit.Quantity</cite></span></dt><dd><p>Integration step size <span class="math notranslate nohighlight">\(\Delta t\)</span>.</p>
<p><strong>Reference unit</strong>: <span class="math notranslate nohighlight">\(\mathrm{ps}\)</span>.</p>
</dd>
<dt><strong>n_cells</strong><span class="classifier"><cite>int</cite>, keyword-only, default: <code class="code docutils literal notranslate"><span class="pre">2</span></code></span></dt><dd><p>Total number <span class="math notranslate nohighlight">\(n_\mathrm{cell}\)</span> of cells, with <span class="math notranslate nohighlight">\(1\)</span>
real and <span class="math notranslate nohighlight">\(n_\mathrm{cell}-1\)</span> image cells.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Use <span class="math notranslate nohighlight">\(n_\mathrm{cell}&gt;2\)</span> to instantiate a
highly-confined simulation system with periodic dimensions
large enough to satisfy the constraint that the force field
cutoff be less than half the box size.</p>
</div>
</dd>
<dt><strong>nbforce</strong><span class="classifier"><cite>openmm.NonbondedForce</cite>, keyword-only, optional</span></dt><dd><p>Standard Lennard-Jones (LJ) and Coulomb pair potential used in
OpenMM. For the image charges, the charges <span class="math notranslate nohighlight">\(q\)</span> are flipped
while the LJ parameters <span class="math notranslate nohighlight">\(\sigma\)</span> and <span class="math notranslate nohighlight">\(\epsilon\)</span> are
set to <span class="math notranslate nohighlight">\(0\)</span>.</p>
</dd>
<dt><strong>cnbforces</strong><span class="classifier"><cite>dict</cite>, keyword-only, optional</span></dt><dd><p>Custom pair potential objects implementing other non-standard
pair potentials. The keys are the potentials and the values are
the corresponding per-particle parameters to use, which can be
provided as follows:</p>
<div class="docutils container">
<ul class="simple">
<li><p><cite>None</cite>: All per-particle parameters set to <span class="math notranslate nohighlight">\(0\)</span>.</p></li>
<li><p><cite>dict</cite>: Information on how to transform the real particle
parameters into those for the image charges. The valid
(optional) key-value pairs are:</p>
<ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">&quot;charge&quot;</span></code>: Index (<cite>int</cite>) where the charge
<span class="math notranslate nohighlight">\(q\)</span> information is stored.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">&quot;zero&quot;</span></code>: Index (<cite>int</cite>) or indices (<cite>list</cite>,
<cite>slice</cite>, or <cite>numpy.ndarray</cite>) of parameters to zero out.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">&quot;replace&quot;</span></code>: <cite>dict</cite> containing key-value pairs of
indices (<cite>int</cite>) of parameters to change and their
replacement value(s). If the value is an <cite>int</cite>, all
particles receive that value for the current pair
potential. If the value is another <cite>dict</cite>, the new
parameter value (value of inner <cite>dict</cite>) is determined by
the current parameter value (key of inner <cite>dict</cite>).</p></li>
</ul>
</li>
</ul>
</div>
<p>To prevent unintended behavior, ensure that each parameter index
for a custom pair potential is used only once across the keys
listed above. If one does appear more than once, the order
in which parameter values are updated follows that of the list
above.</p>
<p>See the Examples section below for a simple illustration of the
possibilities outlined above.</p>
</dd>
<dt><strong>wall_indices</strong><span class="classifier">array-like, keyword-only, optional</span></dt><dd><p>Atom indices corresponding to wall particles. If not provided,
the wall particles are guessed using the system dimensions.</p>
</dd>
<dt><strong>exclude</strong><span class="classifier"><cite>bool</cite>, keyword-only, default: <code class="code docutils literal notranslate"><span class="pre">False</span></code></span></dt><dd><p>Specifies whether interactions between a wall particle and all
image wall particles should be excluded. If <code class="code docutils literal notranslate"><span class="pre">False</span></code>, only
the interaction between a wall particle and its own image is
removed.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want accurate forces acting on wall particles, set
<code class="code docutils literal notranslate"><span class="pre">exclude=True</span></code>.</p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>positions</strong><span class="classifier"><cite>numpy.ndarray</cite></span></dt><dd><p>Positions of the <span class="math notranslate nohighlight">\(N\)</span> particles in the real system and
their images.</p>
<p><strong>Shape</strong>: <span class="math notranslate nohighlight">\((2N,\,3)\)</span>.</p>
<p><strong>Reference unit</strong>: <span class="math notranslate nohighlight">\(\mathrm{nm}\)</span>.</p>
</dd>
<dt><strong>integrator</strong><span class="classifier"><cite>openmm.Integrator</cite></span></dt><dd><p>Integrator that simulates a system using Langevin dynamics, with
the LFMiddle discretization.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="rb319b78fd6ee-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Hautman, J.; Halley, J. W.; Rhee, Y. J. Molecular Dynamics
Simulation of Water Beween Two Ideal Classical Metal Walls.
<em>J. Chem. Phys.</em> <strong>1989</strong>, <em>91</em> (1), 467472.
<a class="reference external" href="https://doi.org/10.1063/1.457481">https://doi.org/10.1063/1.457481</a>.</p>
</div>
<div class="citation" id="rb319b78fd6ee-2" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>Dwelle, K. A.; Willard, A. P. Constant Potential,
Electrochemically Active Boundary Conditions for Electrochemical
Simulation. <em>J. Phys. Chem. C</em> <strong>2019</strong>, <em>123</em> (39), 2409524103.
<a class="reference external" href="https://doi.org/10.1021/acs.jpcc.9b06635">https://doi.org/10.1021/acs.jpcc.9b06635</a>.</p>
</div>
<div class="citation" id="rb319b78fd6ee-3" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p>Son, C. Y.; Wang, Z.-G. Image-Charge Effects on Ion
Adsorption near Aqueous Interfaces. <em>Proc. Natl. Acad. Sci.
U.S.A.</em> <strong>2021</strong>, <em>118</em> (19), e2020615118.
<a class="reference external" href="https://doi.org/10.1073/pnas.2020615118">https://doi.org/10.1073/pnas.2020615118</a>.</p>
</div>
</div>
<p class="rubric">Examples</p>
<p>Prepare the <cite>cnbforces</cite> <cite>dict</cite> argument for a system with the
following custom pair potentials:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">PairGauss</span></code>: Gaussian potential with per-particle
parameters <cite>type</cite> and <cite>beta</cite>.</p>
<ul>
<li><p><cite>type</cite> is the particle type, and is used to look up a
tabulated function for parameter values. As such, the new
values will vary and depend on the old ones. For example, for
a system with <span class="math notranslate nohighlight">\(2\)</span> types of particles, <span class="math notranslate nohighlight">\(0\)</span> becomes
<span class="math notranslate nohighlight">\(2\)</span> and <span class="math notranslate nohighlight">\(1\)</span> becomes <span class="math notranslate nohighlight">\(3\)</span>.</p></li>
<li><p><cite>beta</cite> is assumed to be constant, with the value for the real
particles differing from that for image charges. For this
example, the new value is <span class="math notranslate nohighlight">\(\beta = 42\)</span> (arbitrary
units).</p></li>
</ul>
</li>
<li><p><code class="code docutils literal notranslate"><span class="pre">PairWCA</span></code>: WeeksChanderAndersen potential with per-
particle parameters <cite>sigma</cite> and <cite>epsilon</cite>, both of which
should be set to <span class="math notranslate nohighlight">\(0\)</span> to turn off this potential for
image charges.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">PairCoulRecip</span></code>: Smeared Coulomb potential with per-
particle parameter <cite>charge</cite>, which should be flipped for image
charges, and <cite>dummy</cite>, a value that should be set to <span class="math notranslate nohighlight">\(0\)</span>.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NEW_BETA_VALUE</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">cnbforces</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">PairGauss</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;replace&quot;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="mi">1</span><span class="p">:</span> <span class="n">NEW_BETA_VALUE</span><span class="p">}},</span>
    <span class="n">PairWCA</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">PairCoulRecip</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;charge&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;zero&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="mdhelper.openmm.system.register_particles.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">register_particles</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="mdhelper.openmm.system.estimate_pressure_tensor.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">estimate_pressure_tensor</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Benjamin Ye
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">image_charges</a><ul>
<li><a class="reference internal" href="#mdhelper.openmm.system.image_charges"><code class="docutils literal notranslate"><span class="pre">image_charges()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>